## Build Instructions
Run the following commands

```shell
phpize && ./configure
make
make test
```

see also http://wiki.zeromq.org/bindings:php

## Auto Generation

### Sockopts
The ZMQ Lib functionality depends mostly on the sockopt flags which can be
set on libzmq. In order to keep these flags in sync with the upstream
library the flags can be automatically pulled by a script.

To do this you will need to install the gsl library, see also https://github.com/imatix/gsl

```shell
git clone https://github.com/imatix/gsl
cd gsl/src
make
sudo make install
```

Then run from the project root directory `./options/generate.sh` to update
the sockopts.

### api.php generation

The api definition can be auto generated by the tool DocThor.
Note: This requires to build the extension first and specify on the command
line.

```shell
git clone https://github.com/SegFaulty/DocThor
php -d extension=modules/zmq.so DocThor/DocThor.php --sourceDir=./ zmq
```

## Windows Build Instructions (PHP 8.x)
* `git clone https://github.com/Microsoft/php-sdk-binary-tools`
* Open "Developer Command Prompt for VS2019" 
* All commands listed below must be run using the VS2019 command prompt you just opened:
* cd into the directory you just cloned, and run `phpsdk-vs16-x64.bat`
* `phpsdk_buildtree phpdev`
* Download source code of the PHP version you're building for: https://windows.php.net/download/
* Extract the source code under `<php-sdk-binary-tools>/phpdev/vs16/x64/php-8.2.4-src` (replace php version with whatever version you downloaded)
* Download libzmq: https://github.com/zeromq/libzmq/releases (eg. libzmq-v142-x64-4_3_4.zip)
* Extract under `<php-sdk-binary-tools>/phpdev/vs16/x64/zmq`
* In that folder, rename libzmq-v142-mt-4_3_4.lib to libzmq.lib
* Clone this repo into  `<php-sdk-binary-tools>/phpdev/vs16/x64/php-8.2.4-src/ext/zmq`
* `cd <php-sdk-binary-tools>/phpdev/vs16/x64/php-8.2.4-src`
* `buildconf`
* `configure --with-zmq="<php-sdk-binary-tools>/phpdev/vs16/x64/zmq,shared"`
* `nmake`